{"version":3,"sources":["webpack:///./src/pages/share.vue?e8d3","webpack:///./src/pages/share.vue","webpack:///./src/pages/share.vue?3059"],"names":["class","id","scan","hour","min","sec","name","components","setup","route","timeId","query","state","info","init","window","clearInterval","computeTime","endTime","nowTime","Date","getTime","timeInSec","parseInt","console","log","shareId","localStorage","getItem","setItem","res","default","startTime","setInterval","toDataURL","then","url","canvas","document","getElementById","ctx","getContext","image","Image","onload","event","width","height","drawImage","image1","e","src","catch","err","error","methods","__exports__","render"],"mappings":"yIAAA,W,4DCCOA,MAAM,c,EACT,gCAAmB,UAAf,cAAU,G,sBAKd,gCAAyB,SAAtB,sBAAkB,G,EACrB,gCAAkC,SAA/B,+BAA2B,G,EAE9B,gCAA6B,UAArBC,GAAG,UAAQ,S,wDATrB,gCAUM,MAVN,EAUM,CATJ,EACU,EAAAC,KAAI,G,yBAAd,gCAEK,OAFe,iBACL,6BAAG,EAAAC,MAAO,MAAG,6BAAG,EAAAC,KAAM,MAAG,6BAAG,EAAAC,KAAM,SACjD,K,yBACA,gCAAsC,OAA3B,2BACX,EACA,EACA,gCAAmC,SAAhC,OAAI,6BAAG,EAAAH,MAAO,iBAAc,GAC/B,I,mHASW,GACbI,KAAM,QACNC,WAAY,GACZC,MAHa,WAIX,IAAIC,EAAQ,iBAGRC,GAFS,iBAAI,MACLD,EAAME,MACL,MACPC,EAAQ,sBAAS,CACrBC,KAAM,KACNV,KAAM,EACNC,IAAK,EACLC,IAAK,EACLH,KAAM,IAGR,wBAAU,WACRY,OAEF,8BAAgB,WACdC,OAAOC,cAAcN,MAGvB,IAAMO,EAAc,SAACC,GACnB,IAAIC,GAAU,IAAIC,MAAOC,UACrBC,GAAaJ,EAAUC,GAAW,IACtCP,EAAMT,KAAOoB,SAASD,EAAY,GAAK,IACvCV,EAAMR,IAAMmB,SAAUD,EAAY,GAAM,IACxCV,EAAMP,IAAMkB,SAASD,EAAY,IACjCE,QAAQC,IAAIb,EAAMT,KAAMS,EAAMR,IAAKQ,EAAMP,MAErCS,EAAG,yDAAI,iHAEPY,EAAUC,aAAaC,QAAQ,WAC9BF,IACHA,EAAU,8BAAgC,iBAC1CC,aAAaE,QAAQ,UAAWH,IALvB,SAOK,oDAPL,OAOPI,EAPO,OAQPjB,EAAOiB,EAAIC,QACfnB,EAAMV,KAAOW,EAAKX,KACdgB,EAAUL,EAAKmB,UAAY,KAC3Bd,IAAW,IAAIE,MAAOC,YACxBH,GAAU,IAAIE,MAAOC,UAAY,MAEnCJ,EAAYC,GACZR,EAASK,OAAOkB,aAAY,WAC1BhB,EAAYC,KACX,KACH,IAAOgB,UAAUR,GACdS,MAAK,SAACC,GACLZ,QAAQC,IAAIW,GACZ,IAAMC,EAASC,SAASC,eAAe,UACjCC,EAAMH,EAAOI,WAAW,MACxBC,EAAQ,IAAIC,MAClBD,EAAME,OAAS,SAAUC,GAGvBR,EAAOS,MAAQ,IACfT,EAAOU,OAAS,IAEhBP,EAAIQ,UACFN,EACA,EACA,EACAA,EAAMI,MACNJ,EAAMK,OACN,EACA,EACA,IACA,KAEF,IAAIE,EAAS,IAAIN,MACjBM,EAAOL,OAAS,SAAUM,GAGxBV,EAAIQ,UACFC,EACA,EACA,EACAA,EAAOH,MACPG,EAAOF,OACP,GACA,GACA,IACA,MAGJE,EAAOE,IAAMf,GAEfM,EAAMS,IACJ,8PAEHC,OAAM,SAACC,GACN7B,QAAQ8B,MAAMD,MA/DP,4CAAJ,qDAkEHE,EAAU,GAEhB,wCACK,oBAAO3C,IACP2C,K,iCCjHT,MAAMC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-74f4b6ca.f3b39419.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./share.vue?vue&type=style&index=0&id=14c880ec&lang=css\"","<template>\n  <div class=\"share-page\">\n    <h3>以为您生成分享二维码</h3>\n    <h3 v-if=\"scan < 2\">\n      请在24小时内完成：还有 {{ hour }} 时 {{ min }} 分 {{ sec }} 秒 到期\n    </h3>\n    <h3 v-else>您已完成分享任务！24小时内办理即可享受优惠</h3>\n    <p>规则：长按二维码2秒->分享到微信群</p>\n    <p>只要两名用户通过您分享的二维码打开平台即可立减30元！</p>\n    <p>状态: {{ scan }} 人已扫描您分享的二维码进入</p>\n    <canvas id=\"canvas\"></canvas>\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, onMounted, ref, onBeforeUnmount } from \"vue\";\nimport { useRoute } from \"vue-router\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport QRCode from \"qrcode\";\nexport default {\n  name: \"index\",\n  components: {},\n  setup() {\n    let route = useRoute();\n    let image1 = ref(null);\n    let query = route.query;\n    let timeId = null;\n    const state = reactive({\n      info: null,\n      hour: 0,\n      min: 0,\n      sec: 0,\n      scan: 0,\n    });\n\n    onMounted(() => {\n      init();\n    });\n    onBeforeUnmount(() => {\n      window.clearInterval(timeId);\n    });\n\n    const computeTime = (endTime) => {\n      let nowTime = new Date().getTime();\n      let timeInSec = (endTime - nowTime) / 1000;\n      state.hour = parseInt(timeInSec / 60 / 60);\n      state.min = parseInt((timeInSec / 60) % 60);\n      state.sec = parseInt(timeInSec % 60);\n      console.log(state.hour, state.min, state.sec);\n    };\n    const init = async () => {\n      // With promises\n      let shareId = localStorage.getItem(\"shareId\");\n      if (!shareId) {\n        shareId = \"https://www.baidu.com/s?wd=\" + uuidv4();\n        localStorage.setItem(\"shareId\", shareId);\n      }\n      let res = await import(\"../mock/shareInfo.json\");\n      let info = res.default;\n      state.scan = info.scan;\n      let endTime = info.startTime + 1000 * 60 * 60 * 2;\n      if (endTime <= new Date().getTime()) {\n        endTime = new Date().getTime() + 1000 * 60 * 60 * 2;\n      }\n      computeTime(endTime);\n      timeId = window.setInterval(() => {\n        computeTime(endTime);\n      }, 1000);\n      QRCode.toDataURL(shareId)\n        .then((url) => {\n          console.log(url);\n          const canvas = document.getElementById(\"canvas\");\n          const ctx = canvas.getContext(\"2d\");\n          const image = new Image();\n          image.onload = function (event) {\n            // console.log(event, this);\n\n            canvas.width = 300;\n            canvas.height = 400;\n\n            ctx.drawImage(\n              image,\n              0,\n              0,\n              image.width,\n              image.height,\n              0,\n              0,\n              300,\n              400\n            );\n            var image1 = new Image();\n            image1.onload = function (e) {\n              // console.log(event, this);\n\n              ctx.drawImage(\n                image1,\n                0,\n                0,\n                image1.width,\n                image1.height,\n                10,\n                85,\n                270,\n                270\n              );\n            };\n            image1.src = url;\n          };\n          image.src =\n            \"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg3.027art.cn%2Fimg%2F2021%2F08%2F10%2F1628544775701610.jpg&refer=http%3A%2F%2Fimg3.027art.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1644920651&t=9014bdd4e8ea700e739803f80b64c630\";\n        })\n        .catch((err) => {\n          console.error(err);\n        });\n    };\n    const methods = {};\n\n    return {\n      ...toRefs(state),\n      ...methods,\n    };\n  },\n};\n</script>\n<style>\n#canvas {\n  /* width: 15rem; */\n}\n</style>\n","import { render } from \"./share.vue?vue&type=template&id=14c880ec\"\nimport script from \"./share.vue?vue&type=script&lang=js\"\nexport * from \"./share.vue?vue&type=script&lang=js\"\n\nimport \"./share.vue?vue&type=style&index=0&id=14c880ec&lang=css\"\n\nimport exportComponent from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\project\\\\wx-project-1\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}